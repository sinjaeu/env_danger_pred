# 🌤️ 기상 기반 사망률 예측 시스템 (30일 데이터 특화)

## 📋 프로젝트 개요

이 프로젝트는 기상청 API를 통해 최근 30일 기상 데이터를 수집하고, 기온과 습도를 예측하며, 논문 기반 위험도 모델로 사망률을 계산하는 Streamlit 애플리케이션입니다.

### 🎯 주요 특징

- **30일 데이터 특화**: 오늘을 제외한 최근 30일 데이터만 사용
- **버튼 클릭 방식**: 설정 완료 후 버튼을 눌러 데이터 분석 시작
- **필수 기상 데이터**: 평균 기온, 최고 기온, 최저 기온, 평균 습도만 수집
- **시간 가중치 모델**: 최근 데이터에 높은 가중치를 적용한 예측
- **종합 분석**: 6개 서브플롯으로 구성된 상세 분석 차트
- **모듈화 구조**: 기능별로 분리된 깔끔한 코드 구조

## 🚀 시작하기

### 1. 환경 설정

```bash
# 필요한 패키지 설치
pip install -r requirements.txt
```

### 2. API 키 설정

기상청 API Hub에서 발급받은 API 키를 설정하세요.

### 3. 애플리케이션 실행

```bash
streamlit run weather_mortality_prediction.py
```

## 📊 주요 기능

### 1. 데이터 로드 방식
- **설정 후 실행**: 사이드바에서 설정을 완료한 후 "30일 기상 데이터 분석 시작" 버튼 클릭
- **필수 데이터만**: 평균 기온, 최고 기온, 최저 기온, 평균 습도만 수집
- **오늘 제외**: 최근 30일 데이터에서 오늘을 제외한 데이터 사용

### 2. 5개 분석 탭

#### 📈 기상 트렌드 탭
- 최근 30일 기상 트렌드 분석
- 기온-습도 산점도

#### 🔍 30일 패턴 분석 탭
- 30일 데이터 패턴 분석
- 이상치 탐지 및 분석
- 트렌드 분석
- 상세 분석 리포트

#### 🔮 예측 분석 탭
- 시간 가중치 기반 기상 예측
- 사망률 예측 및 위험도 분석
- 예측 트렌드 차트
- 사망률 트렌드 분석

#### 📊 상세 분석 탭
- 필터링된 데이터 분석
- 기온별 필터링
- 상세 통계 정보

### 3. 시간 가중치 예측 모델

- **최근 데이터 우선**: 최근 데이터에 높은 가중치 적용
- **선형 감소 가중치**: 과거로 갈수록 가중치 감소

## 📁 프로젝트 구조

```
논문/
├── weather_mortality_prediction.py  # 메인 애플리케이션
├── weather_api.py                   # 기상청 API 연동
├── data_loader.py                   # 데이터 로드 및 정리
├── data_analyzer.py                 # 데이터 분석
├── weather_prediction.py            # 기상 예측 (시간 가중치)
├── mortality_calculator.py          # 사망률 계산
├── visualization.py                 # 시각화
├── ui_components.py                 # UI 컴포넌트
├── utils.py                         # 유틸리티 함수
├── requirements.txt                 # 의존성 패키지
├── station_codes.md                 # 지점 코드
└── 논문_참조_내용.txt               # 논문 참조 내용
```

## 🔧 주요 모듈 설명

### weather_mortality_prediction.py
- 메인 Streamlit 애플리케이션
- 버튼 클릭 방식의 데이터 로드
- 5개 탭으로 구성된 UI

### weather_api.py
- 기상청 API 연동
- 필수 기상 데이터만 수집 (평균/최고/최저 기온, 평균 습도)
- 오류 처리 및 대체 데이터 생성

### data_loader.py
- 30일 데이터 로드 및 정리
- 데이터 품질 검증
- 오늘 제외한 데이터 처리

### weather_prediction.py
- 시간 가중치 기반 예측 모델
- 최근 데이터에 높은 가중치 적용
- 선형 감소 가중치 시스템

## 📊 수집하는 기상 데이터

### 필수 데이터 항목
1. **평균 기온** (°C): 일 평균 기온
2. **최고 기온** (°C): 일 최고 기온
3. **최저 기온** (°C): 일 최저 기온
4. **평균 습도** (%): 일 평균 상대습도

### 데이터 소스
- **기상청 API Hub**: 실제 기상 데이터
- **대체 데이터**: API 오류 시 생성되는 시뮬레이션 데이터

## 🎨 시각화 기능

### 종합 분석 차트 (6개 서브플롯)
1. 기온 트렌드
2. 습도 트렌드
3. 기온-습도 산점도
4. 이상치 분석
5. 트렌드 분석

### 추가 차트
- 위험도 요인 분석
- 사망률 트렌드
- 예측 결과 시각화

## 🔍 데이터 분석 기능

### 30일 패턴 분석
- 데이터 품질 검증
- 이상치 탐지
- 트렌드 분석
- 상세 통계 계산

### 통계 정보
- 기본 통계 (평균, 최고, 최저, 표준편차)
- 계절별 통계
- 데이터 품질 지표

## 📈 예측 모델

### 시간 가중치 시스템
- 최근 데이터: 높은 가중치 (1.0)
- 과거 데이터: 선형 감소 가중치
- 가중 평균 기반 예측

### 사망률 계산
- 논문 기반 위험도 모델
- 연령대별, 성별 차이 반영
- 계절별 특성 고려

## 🛠️ 기술 스택

- **Python**: 3.8+
- **Streamlit**: 웹 애플리케이션 프레임워크
- **Pandas**: 데이터 처리
- **NumPy**: 수치 계산
- **Plotly**: 인터랙티브 시각화
- **Scikit-learn**: 머신러닝 (시간 가중치 모델)
- **Requests**: API 통신

## 📝 사용법

1. **애플리케이션 실행**
   ```bash
   streamlit run weather_mortality_prediction.py
   ```

2. **설정 완료**
   - 사이드바에서 도시, 연령대, 성별 선택
   - 예측 날짜 설정

3. **데이터 분석 시작**
   - "30일 기상 데이터 분석 시작" 버튼 클릭
   - 데이터 로드 및 분석 진행

4. **결과 확인**
   - 5개 탭에서 다양한 분석 결과 확인
   - 차트 및 통계 정보 탐색

## 🔧 설정 옵션

### 기본 설정
- **도시 선택**: 서울, 부산, 대구, 인천, 광주, 대전, 울산, 제주
- **연령대**: 20-29세, 30-39세, 40-49세, 50-59세, 60-69세, 70세 이상
- **성별**: 남성, 여성

### 고급 설정
- **예측 날짜**: 미래 날짜 설정

## 📊 데이터 품질

### 검증 항목
- 데이터 완성도 (30일)
- 이상치 탐지
- 결측값 처리
- 데이터 일관성

### 품질 지표
- 데이터 수집 성공률
- 이상치 비율
- 계절별 분포
- 트렌드 일관성

## 🚨 주의사항

1. **API 키 필요**: 기상청 API Hub에서 발급받은 API 키가 필요합니다.
2. **데이터 제한**: 오늘을 제외한 최근 30일 데이터만 사용합니다.
3. **예측 한계**: 예측 결과는 참고용이며, 실제 의학적 판단의 근거로 사용하지 마세요.
4. **네트워크**: 인터넷 연결이 필요합니다.

## 📞 지원

문제가 발생하거나 개선 사항이 있으시면 이슈를 등록해 주세요.

---

**⚠️ 면책 조항**: 이 시스템은 연구 및 교육 목적으로 제작되었습니다. 의학적 판단이나 실제 건강 관리에 사용하지 마세요. 